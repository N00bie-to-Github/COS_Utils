
<!DOCTYPE html>
<html lang="en">

<head>
  <title>Label Maker</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="" />
  <style>
    body,
    html {
      margin: 0;
      padding: 0;
      border: 0;
    }

    .panel {
      background: #EFEFEF;
      padding: 20px;
    }

    .row-label-text {
      display: inline-block;
      width: 100px;
    }

    .panel-row {
      margin-top: 10px;
    }

    .panel-row:first-child {
      margin-top: 0;
    }

    .panel-row input[type=text] {
      padding: 5px;
    }

    @media print {

      .no-print,
      .no-print * {
        display: none !important;
      }
    }

    .template {
      display: none;
    }

    #page {
      width: 10in;
      height: 7.5in;
    }

    .card {
      font-family: Arial, Helvetica, sans-serif;
      background-color: rgb(69, 70, 73);
      color: rgb(145, 116, 82);
      margin-bottom: 10px;
    }

    .top,
    .bottom {
      min-height: 83px;
      line-height: 83px;
    }

    .bottom {
      margin-top: 0.375in;
    }

    .downstairs.single {
      padding-top: 0.375in;
      padding-right: 0.5in;
      padding-left: 1in;
      height: 2.5in;
      width: 6.75in;
      font-size: 100px;
    }
    .alert {
      color: red;
      font-weight: bold;
      display: inline-block;
      padding: 15px;
      margin-bottom: 15px;
      background: rgb(255, 210, 217);
    }
    .instructions {
      /* font-style: italic; */
      font-size: 12pt;
    }
    .closer {
      height: 30px;
      width: 30px;
      font-size: 25px;
      float: right;
      cursor: pointer;
    }
    
  </style>
</head>

<body>
  <div class="panel no-print">
    <div class="panel-row">
      <span class="alert instructions">
        Instructions:<br/>
        Select the type of card you want to create. Add the information in the form below. When you're finished, right click the page and select print.
        Make sure to turn on background images when printing.
      </span>
    </div>
    <div class="panel-row">
      <label class="row-label"><span class="row-label-text">First Name:</span>
        <input id="first-name" type="text" value="fn" />
      </label>
    </div>
    <div class="panel-row">
      <label class="row-label"><span class="row-label-text">Last Name:</span>
        <input id="last-name" type="text" value="ln" />
      </label>
    </div>
    <div class="panel-row">
      <label class="row-label"><span class="row-label-text">Title:</span>
        <input id="title" type="text" value="title" />
      </label>
    </div>
    <div class="panel-row">
      <label class="row-label multiple">
        <div>
          <input type="radio" class="label-type" value="downstair-single" checked /> Downstairs Single
        </div>
        <div>
          <input type="radio" class="label-type" value="downstair-double" /> Downstairs Double
        </div>
      </label>
    </div>
    <div class="panel-row">
      <button id="add-button">Add Label</button>
    </div>
  </div>
  <div class="templates">
    <div id="__downstairs_single__" class="card downstairs single template">
      <!-- <div class="closer">⮽</div> -->
      <div class="top"><span>Martin Donk</span></div>
      <div class="bottom"><span>Engineering Project Manager</span></div>
    </div>
  </div>
  <div id="page"></div>

  <script>
    function clone(o) {
      return JSON.parse(JSON.stringify(o));
    }

    function getFontSize(el) {
      return parseInt(getComputedStyle(el).fontSize);
    }
    /**
     * Initial max size roughly equals 3/4 inch
     */
    function fitText(el, maxHeight = 86) {
      var fontSize = getFontSize(el);
      // Check the height of the div. 
      // Keep decreasing the font size until it's set to the specified max height
      while (el.offsetHeight > maxHeight) {
        var size = `${--fontSize}px`;
        el.style.fontSize = size;
        el.style.lineHeight = size;
      }
    }
    // EVENTS
    var addButton = document.getElementById('add-button');
    var fnInput = document.getElementById('first-name');
    var lnInput = document.getElementById('last-name');
    var titInput = document.getElementById('title');

    addButton.addEventListener('click', function () {
      var firstName = fnInput.value;
      var lastName = lnInput.value;
      var title = titInput.value;

      var card = document.querySelector('#__downstairs_single__').cloneNode(true);
      card.classList.remove('template');
      card.style.display = 'block';
      card.removeAttribute('id');

      // Populate it with the form data
      card.querySelector('.top').innerHTML = `${firstName} ${lastName}`;
      card.querySelector('.bottom').innerHTML = `${title}`;
      // [...card.querySelector('.bottom')].forEach(e=>e.innerHTML = `${title}`);

      page = document.getElementById('page');
      var wrapper = document.createElement('div');
      wrapper.classList.add('card-wrapper');
      var closer = document.createElement('div');
      closer.classList.add('closer');
      closer.innerHTML = '⮽';

      // Bind the close event
      closer.addEventListener('click', function() {
        wrapper.remove();
      });

      wrapper.appendChild(closer);
      wrapper.appendChild(card);
      
      page.appendChild(wrapper);

      // Make the text fit
      [...document.querySelectorAll('.top')].forEach((e) => fitText(e));
      [...document.querySelectorAll('.bottom')].forEach((e) => fitText(e));

      console.log(card)
    });
    // [...document.querySelectorAll('.bottom')].forEach(function (el) {
    //   fitText(el);
    // });

    // [...document.getElementsByClassName('card')].forEach(function(e) {
    //   console.log(e.offsetHeight, e.offsetWidth)
    // })
    function Label() {

    }
  </script>
</body>

</html>
